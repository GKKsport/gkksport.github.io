<!DOCTYPE html>
<html>

<head>
  <title>GKK Sport</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.10/css/all.css" integrity="sha384-+d0P83n9kaQMCwj8F4RJB66tzIwOKmrdb46+porD/OvrJ+37WqIM7UoBtwHO6Nlg" crossorigin="anonymous">
  <link rel="icon" sizes="192x192" href="icon.png">
  <style>
    /* Remove the navbar's default margin-bottom and rounded borders */

    @media (min-width: 767px) {
      ul.nav li.dropdown:hover>ul.dropdown-menu {
        display: block;
      }
    }

    .navbar {
      margin-bottom: 0;
      border-radius: 0;
    }

    /* Set height of the grid so .sidenav can be 100% (adjust as needed) */

    .row.content {
      height: 450px
    }

    /* Set gray background color and 100% height */

    .sidenav {
      padding-top: 20px;
      background-color: #f1f1f1;
      height: 100%;
    }

    /* Set black background color, white text and some padding */

    .navbar-brand img {
      height: 40px;
    }

    .navbar-brand {
      padding-bottom: 3px;
      padding-top: 6px;
    }

    footer {
      background-color: #555;
      color: white;
      padding: 15px;
    }

    .bold {
      font-weight: bold;
    }

    /* On small screens, set height to 'auto' for sidenav and grid */

    @media screen and (max-width: 767px) {
      .sidenav {
        height: auto;
        padding: 15px;
      }
      .row.content {
        height: auto;
      }
    }
  </style>
  <script type="text/javascript" src="./js/moment.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
  <script>
    $(function() {
      $("#menu").load("menu.html");
    });
  </script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-119797754-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'UA-119797754-1');
  </script>
</head>

<body>

  <nav class="navbar navbar-inverse">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
        <a class="navbar-brand" href="index.html"><img src="GKK.png"></a>
      </div>
      <div id="menu">
      </div>
    </div>
  </nav>
  <div class="container-fluid text-center">


    <br>
    <div id="testtest">

    </div>
    <div class="table-responsive" id="tabelweer">
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th>Datum</th>
            <th>Tijd</th>
            <th>Temp</th>
            <th>Windsnel</th>
            <th>Windstoot</th>
            <th>Luchtvochtig</th>
            <th>Neerslagkans</th>
            <th>Neerslag</th>
            <th>Bewolking</th>
            <th>UV</th>
            <th>Zichtbaarheid</th>
          </tr>
        </thead>
        <tbody id="tabel">

        </tbody>
      </table>
    </div>


  </div>

  <script>
    function loc() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
          var lat = position.coords.latitude;
          var long = position.coords.longitude;

          function adresWeer() {

            var key = "bc19b1b471805791801dd3098e6b3b59";
            weerurl = "https://api.darksky.net/forecast/" + key + "/" + lat + "," + long + "?exclude=minutely,flags&lang=nl&units=ca&extend=hourly";
            console.log(weerurl);
            $.ajax({
              url: weerurl,
              dataType: 'JSONP', // JSONP bij normale weerurl
              jsonpCallback: 'callback',
              type: 'GET',
              success: function(data) {

                document.getElementById("tabel").innerHTML = "";
                $("#tabelweer").show();
                for (i = 0; i < 169; i++) {
                  var datum = moment.unix(data.hourly.data[i].time).format("DD/MM"),
                    tijd = moment.unix(data.hourly.data[i].time).format("HH:mm"),
                    temperatuur = (data.hourly.data[i].temperature).toFixed(0),
                    windsnelheid = (data.hourly.data[i].windSpeed).toFixed(1),
                    windstoot = (data.hourly.data[i].windGust).toFixed(1),
                    luchtvochtigheid = (data.hourly.data[i].humidity * 100).toFixed(0),
                    neerslagkans = (data.hourly.data[i].precipProbability * 100).toFixed(0),
                    neerslag = data.hourly.data[i].precipIntensity.toFixed(0),
                    bewolking = (data.hourly.data[i].cloudCover * 100).toFixed(0),
                    uv = data.hourly.data[i].uvIndex,
                    zichtbaarheid = (data.hourly.data[i].visibility).toFixed(0),
                    tijdarray = ["07:00", "08:00", "09:00", "10:00", "11:00", "12:00", "13:00", "14:00", "15:00", "16:00", "17:00", "18:00", "19:00", "20:00"];

                  if ($.inArray(tijd, tijdarray) != -1) {
                    document.getElementById("tabel").innerHTML += "<tr id='tabelrij" + i + "'><td>" + datum + "</td><td>" + tijd + "</td><td>" + temperatuur + "Â°C</td><td id='windsnelheid" + i + "'>" + windsnelheid + " km/u</td><td>" +
                      windstoot + " km/u</td><td>" + luchtvochtigheid + "%</td><td id='neerslagkans" + i + "'>" + neerslagkans + "%</td><td>" + neerslag + "mm</td><td>" + bewolking + "%</td><td>" + UVIndex(uv) + "</td><td>" + zichtbaarheid +
                      "km</td></tr>";

                    if (tijd === "20:00") {
                      document.getElementById("tabel").innerHTML += "<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>";
                    }

                    var neerslagmin = 25,
                      neerslagmax = 50,
                      windsnelheidmin = 10,
                      windsnelheidmax = 20;


                    // vette letters
                    if (neerslagkans >= neerslagmin) {
                      $("#neerslagkans" + [i]).addClass("bold");
                    }
                    if (windsnelheid >= windsnelheidmin) {
                      $("#windsnelheid" + [i]).addClass("bold");
                    }

                    if (neerslagkans >= neerslagmin || windsnelheid >= windsnelheidmin) {
                      $("#tabelrij" + [i]).addClass("warning");
                      if (neerslagkans >= neerslagmax || windsnelheid >= windsnelheidmax) {
                        $("#tabelrij" + [i]).addClass("danger");
                      }
                    } else {
                      $("#tabelrij" + [i]).addClass("success");
                    }

                  }
                }
              }
            });
            $("body").tooltip({
              selector: '[data-toggle=tooltip]'
            });
          };
          adresWeer();
        });


      }
    }

    loc();

    function beaufort(num) {
      var wind = num;
      if (wind < 2) {
        return ("0");
      }
      if (wind < 6) {
        return ("1");
      }
      if (wind < 12) {
        return ("2");
      }
      if (wind < 20) {
        return ("3");
      }
      if (wind < 29) {
        return ("4");
      }
      if (wind < 39) {
        return ("5");
      }
      if (wind < 50) {
        return ("6");
      }
      if (wind < 62) {
        return ("7");
      }
      if (wind < 75) {
        return ("8");
      }
      if (wind < 89) {
        return ("9");
      }
      if (wind < 103) {
        return ("10");
      }
      if (wind < 117) {
        return ("11");
      }
      if (wind >= 117) {
        return ("12");
      }
      return ("0");
    }

    function UVIndex(num) {
      var uv = num;
      if (num < 4) {
        return "<span data-toggle='tooltip' data-placement='bottom' title='geen gevaar'><i class='fas fa-sun'></i> " + num + "</span>";
      } else if (num < 7) {
        return "<span data-toggle='tooltip' data-placement='bottom' title='smeer je in'><i class='fas fa-sun'></i> " + num + "</span>";
      } else if (num < 9) {
        return "<span data-toggle='tooltip' data-placement='bottom' title='zeker insmeren'><i class='fas fa-sun'></i> " + num + "</span>";
      } else {
        return "<span data-toggle='tooltip' data-placement='bottom' title='pas op!'><i class='fas fa-sun'></i> " + num + "</span>";
      }
    }

    function iconweer(string) {
      var icon = string;
      if (icon === "clear-day") {
        return "<i class='wi wi-day-sunny'></i>"
      } else if (icon === "clear-night") {
        return "<i class='wi wi-night-clear'></i>"
      } else if (icon === "rain") {
        return "<i class='wi wi-rain'></i>"
      } else if (icon === "snow") {
        return "<i class='wi wi-snow'></i>"
      } else if (icon === "sleet") {
        return "<i class='wi wi-sleet'></i>"
      } else if (icon === "wind") {
        return "<i class='wi wi-cloudy-gusts'></i>"
      } else if (icon === "fog") {
        return "<i class='wi wi-fog'></i>"
      } else if (icon === "cloudy") {
        return "<i class='wi wi-cloudy'></i>"
      } else if (icon === "partly-cloudy-day") {
        return "<i class='wi wi-day-sunny-overcast'></i>"
      } else if (icon === "partly-cloudy-night") {
        return "<i class='wi wi-night-partly-cloudy'></i>"
      } else {
        return "<i class='wi wi-na'></i>"
      }
    }

    function degToCompass(num) {
      var val = num - 225;
      return "<i style='transform: rotate(" + val + "deg)' class='fas fa-location-arrow'></i>";
    }

    function degToWD(num) {
      var val = Math.floor(((num) / 22.5) + 0.5);
      var arr = ["N", "NNO", "NO", "ONO", "O", "OZO", "ZO", "ZO", "Z", "ZW", "ZW", "WZW", "W", "WNW", "NW", "NNW"];
      return arr[(val % 16)];
    }
  </script>

  <script src="js/auto-complete.js"></script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCm3cVtor4bk3KbwU7w26MZtmKxePJAtsc&libraries=places&callback=loc" async defer></script>
</body>

</html>